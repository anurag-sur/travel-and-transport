<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>AR Bus Model</title>
<script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
<script src="https://raw.githack.com/AR-js-org/AR.js/3.3.2/aframe/build/aframe-ar.js"></script>
<style>
*{ box-sizing:border-box; }
body{
  margin:0;
  overflow:hidden;
  font-family:'Inter',sans-serif;
  background:#0b0b0c;
  color:white;
}
/* Center the scene container */
a-scene {
  height: 100vh;
  width: 100vw;
  display:flex;
  align-items:center;
  justify-content:center;
}
/* Keep only rating UI for simplicity if needed */
#ratingMenu{
  position:absolute;
  bottom:200px;
  left:50%;
  transform:translateX(-50%);
  padding:12px 18px;
  background:rgba(20,20,22,.95);
  backdrop-filter:blur(20px);
  border-radius:16px;
  border:1px solid rgba(255,255,255,.1);
  display:none;
  z-index:5;
  align-items:center;
  gap:6px;
  box-shadow:0 8px 32px rgba(0,0,0,.4);
}
#ratingMenu.show{
  display:flex;
}
.star{
  font-size:32px;
  cursor:pointer;
  color:rgba(255,255,255,.2);
  transition:all .2s;
  line-height:1;
}
.star.active{
  color:#FFD54F;
  text-shadow:0 0 12px rgba(255,213,79,.5);
}
.star:active{ transform:scale(1.3); }
</style>
</head>
<body>

<!-- Rating UI -->
<div id="ratingMenu">
  <span class="star" data-s="1">★</span>
  <span class="star" data-s="2">★</span>
  <span class="star" data-s="3">★</span>
  <span class="star" data-s="4">★</span>
  <span class="star" data-s="5">★</span>
</div>

<!-- Loading indicator -->
<div id="loading" style="position:absolute; inset:0; display:flex; align-items:center; justify-content:center; background:#0b0b0c; z-index:10;">
  <div style="text-align:center;">
    <div id="loadingText">Loading model…</div>
    <div style="width:200px; height:4px; background:rgba(255,255,255,.1); border-radius:2px; overflow:hidden; margin-top:8px;">
      <div id="loadingProgress" style="height:100%; background:linear-gradient(90deg, #1f7aff, #0066ff); width:0%; transition:width .3s;"></div>
    </div>
  </div>
</div>

<!-- A-Frame Scene -->
<a-scene embedded vr-mode-ui="enabled:false" arjs="sourceType:webcam; debugUIEnabled:false;">
  <a-entity light="type:ambient;intensity:0.8"></a-entity>
  <a-entity light="type:directional;intensity:0.4" position="1 2 1"></a-entity>
  <a-entity camera></a-entity>
  <a-entity id="holder" position="0 0 -4"></a-entity>
</a-scene>

<script>
const holder = document.getElementById("holder");
const loading = document.getElementById("loading");
const loadingText = document.getElementById("loadingText");
const loadingProgress = document.getElementById("loadingProgress");
const ratingStars = document.querySelectorAll(".star");
let loadedCount = 0;
let currentModelIndex = 0;
let yaw=0,pitch=0,scale=1;
let autoRotate=true;
let rating=0;

// Only load the bus model
const transport = {model:"models/bus/scene.gltf",name:"Bus",category:"western"};

const entity = document.createElement("a-entity");
entity.setAttribute("gltf-model", transport.model);
entity.object3D.scale.set(2,2,2); // Adjust scale if needed
holder.appendChild(entity);
const model = entity;

model.addEventListener("model-loaded", () => {
  // Model loaded
  loading.style.display='none';
  showToast("Bus model loaded");
  // You can add auto rotation or interaction here
  // start auto rotation
});

function showToast(text){
  alert(text); // simple alert for now
}

// Handle rating stars
const stars = document.querySelectorAll(".star");
stars.forEach(s=>{
  s.onclick=()=>{
    rating=parseInt(s.dataset.s);
    updateStars();
    showToast(`Rated ${rating} ★`);
  };
});
function updateStars(){
  stars.forEach(s=>{
    s.classList.toggle("active",parseInt(s.dataset.s)<=rating);
  });
}

// Optional: Add auto rotate
AFRAME.registerComponent("spin",{
  tick:function(){
    if(autoRotate && model){
      yaw+=0.002;
      model.object3D.rotation.y=yaw;
    }
  }
});
document.querySelector("a-scene").setAttribute("spin","");
</script>

</body>
</html>
